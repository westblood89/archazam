" alt="Archazam Logo">

    <h1>Archazam</h1>
    <div class="slogan">Tarihin Shazam'Ä±</div>

    <div id="status-msg">Model YÃ¼kleniyor...</div>

    <div id="image-preview-container">
        <img id="image-preview" src="#" alt="Ã–nizleme" />
        <div id="loader" class="loader"></div>
        <span id="placeholder-text">GÃ¶rÃ¼ntÃ¼ Bekleniyor</span>
    </div>

    <div class="btn-group">
        <button class="btn-base btn-camera" onclick="triggerCamera()">ğŸ“¸ FotoÄŸraf Ã‡ek</button>
        <button class="btn-base btn-gallery" onclick="triggerGallery()">ğŸ“‚ Galeriden YÃ¼kle</button>
        
        <input type="file" id="file-upload" accept="image/*" onchange="handleImageUpload(this)">
        <input type="file" id="camera-upload" accept="image/*" capture="environment" onchange="handleImageUpload(this)">
        
        <button id="analyze-btn" class="analyze-btn btn-base" onclick="predict()">ğŸ” Analiz Et</button>
    </div>

    <div id="label-container"></div>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>

    <script>
        // Sizin model linkiniz
        const URL = "https://teachablemachine.withgoogle.com/models/stNO7PxAJ/";

        let model, labelContainer, maxPredictions;

        // Sayfa aÃ§Ä±lÄ±nca modeli yÃ¼kle
        async function init() {
            const modelURL = URL + "model.json";
            const metadataURL = URL + "metadata.json";

            try {
                model = await tmImage.load(modelURL, metadataURL);
                maxPredictions = model.getTotalClasses();
                
                document.getElementById("status-msg").innerText = "Sistem HazÄ±r! Bir seramik gÃ¶ster.";
                document.getElementById("status-msg").style.backgroundColor = "#2ECC40"; // YeÅŸil renk
                document.getElementById("loader").style.display = "none";
            } catch (error) {
                document.getElementById("status-msg").innerText = "Hata: Model yÃ¼klenemedi!";
                document.getElementById("status-msg").style.backgroundColor = "#FF4136";
            }
        }

        // Galeri butonuna basÄ±nca
        function triggerGallery() {
            document.getElementById('file-upload').click();
        }

        // Kamera butonuna basÄ±nca
        function triggerCamera() {
            document.getElementById('camera-upload').click();
        }

        // Resim seÃ§ilince Ã¶nizlemeye koy
        function handleImageUpload(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    const imgPreview = document.getElementById('image-preview');
                    imgPreview.src = e.target.result;
                    imgPreview.style.display = 'block';
                    document.getElementById('placeholder-text').style.display = 'none';
                    
                    // Analiz butonunu aktif et
                    document.getElementById('analyze-btn').classList.add('active');
                    document.getElementById("status-msg").innerText = "Analiz iÃ§in hazÄ±r.";
                    document.getElementById("status-msg").style.backgroundColor = "#0074D9";
                    
                    // SonuÃ§larÄ± temizle
                    document.getElementById('label-container').innerHTML = "";
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        // Tahmin YÃ¼rÃ¼tme (Analiz Et)
        async function predict() {
            if(!model) return;

            document.getElementById("status-msg").innerText = "Analiz ediliyor...";
            const image = document.getElementById("image-preview");
            
            // Teachable Machine tahmini
            const prediction = await model.predict(image);

            // SonuÃ§larÄ± ekrana basma (SÄ±ralama: En yÃ¼ksekten dÃ¼ÅŸÃ¼ÄŸe)
            prediction.sort((a, b) => b.probability - a.probability);
            
            const labelContainer = document.getElementById("label-container");
            labelContainer.innerHTML = ""; // Ã–nceki sonuÃ§larÄ± sil

            for (let i = 0; i < maxPredictions; i++) {
                // Sadece %1 Ã¼zerindeki ihtimalleri gÃ¶ster (EkranÄ± kirletmemek iÃ§in)
                if(prediction[i].probability > 0.01) {
                    const classPrediction = prediction[i].className;
                    const probability = (prediction[i].probability * 100).toFixed(1);

                    const resultBar = document.createElement("div");
                    resultBar.className = "result-bar";
                    resultBar.innerHTML = `
                        <div class="bar-text">
                            <span>${classPrediction}</span>
                            <span>%${probability}</span>
                        </div>
                        <div class="bar-bg">
                            <div class="bar-fill" style="width: ${probability}%"></div>
                        </div>
                    `;
                    labelContainer.appendChild(resultBar);
                }
            }
            document.getElementById("status-msg").innerText = "Analiz TamamlandÄ±!";
            document.getElementById("status-msg").style.backgroundColor = "#2ECC40";
        }

        // UygulamayÄ± baÅŸlat
        init();
    </script>
</body>
</html>
